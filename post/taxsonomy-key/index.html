<!doctype html><html lang=ja><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-158035573-1"></script><script>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments);}
gtag('js',new Date());gtag('config','UA-158035573-1');</script><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><title>hugo $taxonomy の $key は大文字が小文字化されるので比較に注意 | tbsmcd.net</title><link rel=stylesheet href=/css/style.css><link rel=stylesheet href=/scss/code.min.daf683076712a8fd05c112ad6575fb841b4d15640f4c87e71541744189b69260.css><link rel=stylesheet href=/css/fonts.css><link rel=stylesheet href=/scss/custom.min.b868658f67598272a29f4f357888ef9656adc57f3d9c5d3c33cfcd7dadb3f119.css><script src=/js/theme.js defer></script><link rel=apple-touch-icon sizes=57x57 href=/apple-icon-57x57.png><link rel=apple-touch-icon sizes=60x60 href=/apple-icon-60x60.png><link rel=apple-touch-icon sizes=72x72 href=/apple-icon-72x72.png><link rel=apple-touch-icon sizes=76x76 href=/apple-icon-76x76.png><link rel=apple-touch-icon sizes=114x114 href=/apple-icon-114x114.png><link rel=apple-touch-icon sizes=120x120 href=/apple-icon-120x120.png><link rel=apple-touch-icon sizes=144x144 href=/apple-icon-144x144.png><link rel=apple-touch-icon sizes=152x152 href=/apple-icon-152x152.png><link rel=apple-touch-icon sizes=180x180 href=/apple-icon-180x180.png><link rel=icon type=image/png sizes=192x192 href=/android-icon-192x192.png><link rel=icon type=image/png sizes=32x32 href=/favicon-32x32.png><link rel=icon type=image/png sizes=96x96 href=/favicon-96x96.png><link rel=icon type=image/png sizes=16x16 href=/favicon-16x16.png><link rel=manifest href=/manifest.json><meta name=msapplication-TileColor content="#ffffff"><meta name=msapplication-TileImage content="/ms-icon-144x144.png"><meta name=theme-color content="#ffffff"><meta name=twitter:card content="summary_large_image"><meta name=twitter:site content="@tbsmcd"><meta name=twitter:creator content="@tbsmcd"><meta property="og:url" content="https://tbsmcd.net/post/taxsonomy-key/"><meta property="og:title" content="hugo $taxonomy の $key は大文字が小文字化されるので比較に注意 | tbsmcd"><meta property="og:description" content="hugo $taxonomy の $key は大文字が小文字化されるので比較に注意"><meta name=description content="hugo $taxonomy の $key は大文字が小文字化されるので比較に注意"><meta property="og:image" content="https://tbsmcd.net/post/taxsonomy-key/ogp.png"></head><body><header>tbsmcd.net <a href=/><span>index</span></a>, <a href=/archives/><span>archives</span></a>, <a href=/tags/><span>tags</span></a>, <a href=/search/><span>search</span></a>, <a href=/profile/><span>profile</span></a> <input type=checkbox id=cb-dark-theme> Dark theme</header><main><h1 class=h1-mono-post><span>hugo $taxonomy の $key は大文字が小文字化されるので比較に注意</span></h1><p class=article-date>2022-06-01 00:59:00 +0900</p><div class=in-article-list><p class="in-article-list-p series-name">Series: シリーズを追加</p><ol class=num-page-list reversed><li>2022-06-01 hugo $taxonomy の $key は大文字が小文字化されるので比較に注意</li><li>2020-10-20 <a href=/post/series-list/>hugo でシリーズ記事一覧を表示するための Shortcode と設定</a></li></ul></div><h2 id=heading>何のこと？</h2><p>ref. <a href=https://gohugo.io/variables/taxonomy/#example-usage-of-sitetaxonomies>https://gohugo.io/variables/taxonomy/#example-usage-of-sitetaxonomies</a></p><p>　リンク先 <code>{{ range$ key, $value := $taxonomy }}</code> における <code>$key</code> のこと。</p><h2 id=heading-1>何が問題？</h2><p>　<a href=https://tbsmcd.net/post/series-list/>以前の記事</a>において以下のような Shortcode を設定した。</p><div class=highlight><pre class=chroma><code class=language-html data-lang=html>{{ $name := .Get &#34;name&#34; }}
<span class=p>&lt;</span><span class=nt>div</span> <span class=na>class</span><span class=o>=</span><span class=s>&#34;in-article-list&#34;</span><span class=p></span><span class=p>&gt;</span>
<span class=p>&lt;</span><span class=nt>p</span> <span class=na>class</span><span class=o>=</span><span class=s>&#34;in-article-list-p&#34;</span><span class=p></span><span class=p>&gt;</span>Series: {{ $name }}<span class=p>&lt;</span><span class=p>/</span><span class=nt>p</span><span class=p>&gt;</span>
<span class=p>&lt;</span><span class=nt>ul</span> <span class=na>class</span><span class=o>=</span><span class=s>&#34;page-list&#34;</span><span class=p></span><span class=p>&gt;</span>
{{ range $key, $series := site.Taxonomies.series }}
    {{ if eq $key $name }}
        {{ range $series.Pages }}
    <span class=p>&lt;</span><span class=nt>li</span><span class=p></span><span class=p>&gt;</span>
        <span class=p>&lt;</span><span class=nt>span</span> <span class=na>class</span><span class=o>=</span><span class=s>&#34;list-date&#34;</span><span class=p></span><span class=p>&gt;</span>{{ .Date.Format &#34;2006/01/02&#34; }}<span class=p>&lt;</span><span class=p>/</span><span class=nt>span</span><span class=p>&gt;</span>
        <span class=p>&lt;</span><span class=nt>br</span><span class=p></span><span class=p>&gt;</span>
        <span class=p>&lt;</span><span class=nt>a</span> <span class=na>href</span><span class=o>=</span><span class=s>&#34;{{ .RelPermalink }}&#34;</span><span class=p></span><span class=p>&gt;</span>{{ .Title | markdownify }}<span class=p>&lt;</span><span class=p>/</span><span class=nt>a</span><span class=p>&gt;</span>
    <span class=p>&lt;</span><span class=p>/</span><span class=nt>li</span><span class=p>&gt;</span>
        {{ end }}
    {{ end }}
{{ end }}
<span class=p>&lt;</span><span class=p>/</span><span class=nt>ul</span><span class=p>&gt;</span>
<span class=p>&lt;</span><span class=p>/</span><span class=nt>div</span><span class=p>&gt;</span>
</code></pre></div><p>シリーズ名に大文字を含む場合、 <code>$name</code> は大文字のままだが、 <code>$key</code> は小文字に変換される。そのため <code>{{ if eq $key $name }}</code> は False となってしまう。</p><h2 id=heading-2>改善方法</h2><div class=highlight><pre class=chroma><code class=language-html data-lang=html>{{ $name := .Get &#34;name&#34; }}
<span class=p>&lt;</span><span class=nt>div</span> <span class=na>class</span><span class=o>=</span><span class=s>&#34;in-article-list&#34;</span><span class=p></span><span class=p>&gt;</span>
<span class=p>&lt;</span><span class=nt>p</span> <span class=na>class</span><span class=o>=</span><span class=s>&#34;in-article-list-p&#34;</span><span class=p></span><span class=p>&gt;</span>Series: {{ $name }}<span class=p>&lt;</span><span class=p>/</span><span class=nt>p</span><span class=p>&gt;</span>
<span class=p>&lt;</span><span class=nt>ul</span> <span class=na>class</span><span class=o>=</span><span class=s>&#34;page-list&#34;</span><span class=p></span><span class=p>&gt;</span>
{{ range $key, $series := site.Taxonomies.series }}
    {{ $key_urlized := $key | urlize }}
    {{ $name_urlized := $name | urlize }}
    {{ if eq $key_urlized $name_urlized }}
        {{ range $series.Pages }}
    <span class=p>&lt;</span><span class=nt>li</span><span class=p></span><span class=p>&gt;</span>
        {{ .Date.Format &#34;2006-01-02&#34; }} <span class=p>&lt;</span><span class=nt>a</span> <span class=na>href</span><span class=o>=</span><span class=s>&#34;{{ .RelPermalink }}&#34;</span><span class=p></span><span class=p>&gt;</span>{{ .Title | markdownify }}<span class=p>&lt;</span><span class=p>/</span><span class=nt>a</span><span class=p>&gt;</span>
    <span class=p>&lt;</span><span class=p>/</span><span class=nt>li</span><span class=p>&gt;</span>
        {{ end }}
    {{ end }}
{{ end }}
<span class=p>&lt;</span><span class=p>/</span><span class=nt>ul</span><span class=p>&gt;</span>
<span class=p>&lt;</span><span class=p>/</span><span class=nt>div</span><span class=p>&gt;</span>
</code></pre></div><p>　上記のように <code>urlize</code> を噛ませて変数に代入する。<code>urlize</code>は文字列を大文字・小文字の区別なく URL エンコードしてくれる。</p><p><a href=https://gohugo.io/functions/urlize/>https://gohugo.io/functions/urlize/</a></p></main><p>Tags:
<a href=/tags/hugo>hugo</a></p><footer><hr>Written by Mochida Tsubasa(@tbsmcd). <a href=https://docs.google.com/forms/d/e/1FAIpQLScLrngN5Znk15zTy06N9qjO3Mi_ubIrXrX9cfYFid_2-mmbQQ/viewform>Contact</a> <a href=/index.xml>Feed</a></footer></body></html>