<!doctype html><html lang=ja><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-158035573-1"></script><script>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments);}
gtag('js',new Date());gtag('config','UA-158035573-1');</script><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><title>Playwright MCP と自作 MPC サーバを連携させ自動で情報取得する AI エージェント | tbsmcd.net</title><link rel=stylesheet href=/css/style.css><link rel=stylesheet href=/scss/code.min.daf683076712a8fd05c112ad6575fb841b4d15640f4c87e71541744189b69260.css><link rel=stylesheet href=/css/fonts.css><link rel=stylesheet href=/scss/custom.min.dcf256d5a0f85d18db523a5742d3f1412ce692686a316cdd6de48b9b0214c4dd.css><script src=/js/main.js defer></script><link rel=apple-touch-icon sizes=57x57 href=/apple-icon-57x57.png><link rel=apple-touch-icon sizes=60x60 href=/apple-icon-60x60.png><link rel=apple-touch-icon sizes=72x72 href=/apple-icon-72x72.png><link rel=apple-touch-icon sizes=76x76 href=/apple-icon-76x76.png><link rel=apple-touch-icon sizes=114x114 href=/apple-icon-114x114.png><link rel=apple-touch-icon sizes=120x120 href=/apple-icon-120x120.png><link rel=apple-touch-icon sizes=144x144 href=/apple-icon-144x144.png><link rel=apple-touch-icon sizes=152x152 href=/apple-icon-152x152.png><link rel=apple-touch-icon sizes=180x180 href=/apple-icon-180x180.png><link rel=icon type=image/png sizes=192x192 href=/android-icon-192x192.png><link rel=icon type=image/png sizes=32x32 href=/favicon-32x32.png><link rel=icon type=image/png sizes=96x96 href=/favicon-96x96.png><link rel=icon type=image/png sizes=16x16 href=/favicon-16x16.png><link rel=manifest href=/manifest.json><meta name=msapplication-TileColor content="#ffffff"><meta name=msapplication-TileImage content="/ms-icon-144x144.png"><meta name=theme-color content="#ffffff"><meta name=twitter:card content="summary_large_image"><meta name=twitter:site content="@tbsmcd"><meta name=twitter:creator content="@tbsmcd"><meta property="og:url" content="https://tbsmcd.net/post/playwright-mcp-with-selfmade-mcp/"><meta property="og:title" content="Playwright MCP と自作 MPC サーバを連携させ自動で情報取得する AI エージェント | tbsmcd"><meta property="og:description" content="Playwright MCP, PDF を OCR し必要な情報を抜き出す自作 MCP サーバを Claude により連携させ、自治体の予算を取得する AI エージェントとして動作させる。動画あり。"><meta name=description content="Playwright MCP, PDF を OCR し必要な情報を抜き出す自作 MCP サーバを Claude により連携させ、自治体の予算を取得する AI エージェントとして動作させる。動画あり。"><meta property="og:image" content="https://tbsmcd.net/post/playwright-mcp-with-selfmade-mcp/ogp.png"></head><body><div class=wrapper><header><div class=title-container><div class="title-item site-title">tbsmcd.net</div><div class=title-item><input type=checkbox id=cb-dark-theme> Dark mode</div></div><div><a href=/><span>index</span></a>, <a href=/archives/><span>archives</span></a>, <a href=/tags/><span>tags</span></a>, <a href=/search/><span>search</span></a>, <a href=/profile/><span>profile</span></a></div></header><main><h1 class=h1-mono-post><span>Playwright MCP と自作 MPC サーバを連携させ自動で情報取得する AI エージェント</span></h1><div class=article-date-box><p class=article-date>Created: 2025-04-21</p></div><h2 id=playwright-mcp->Playwright MCP を触ってみたい</h2><p>　Playwright MCP は2025年3月に Microsoft が発表したブラウザ自動化ツール。AI によるブラウザ操作として画期的なところは、アクセシビリティーツリーを採用し、構造化データを扱うことにあるだろう。</p><div class=highlight><pre class=chroma><code class=language-plain data-lang=plain>Key Features
Fast and lightweight: Uses Playwright&#39;s accessibility tree, not pixel-based input.
LLM-friendly: No vision models needed, operates purely on structured data.
Deterministic tool application: Avoids ambiguity common with screenshot-based approaches.
</code></pre></div><p><a href=https://github.com/microsoft/playwright-mcp>https://github.com/microsoft/playwright-mcp</a></p><p>Claude Desktop から扱うに当たり、（MCP なのに）ただ単品で使うのもつまらないので、自作の MCP サーバと連携させてみた。</p><h3 id=playwright-mcp--1>Playwright MCP のインストール</h3><p>　筆者の環境は Kubuntu（Ubuntu）。</p><div class=highlight><pre class=chroma><code class=language-bash data-lang=bash>sudo npm install -g @playwright/mcp
</code></pre></div><h2 id=-ai->作成する AI エージェント</h2><p>　取得する情報は公共性の高いものということで、自治体の予算情報を選んだ。例えば「滋賀県草津市の2025年度予算のうち教育費はいくらか？」という問いに答えさせる。</p><p>質問から回答までの流れを図示してみた。</p><p><img src=271dedd8.png alt=sq></p><h2 id=-mcp->自作した MCP サーバ</h2><p><a href=https://github.com/tbsmcd/local_gov_budget_mcp/tree/main>https://github.com/tbsmcd/local_gov_budget_mcp/tree/main</a></p><ul><li>Prompt<ul><li>以下のような条件を与える<ul><li>自治体名、年度、項目名は外から与えられる</li><li>Chrome をもちいて自治体の Web サイトを探索する</li><li>金額以外の余計な回答は不要<ul><li>ただしソースは示すように</li></ul></li><li>探索の過程は明示するように</li></ul></li></ul></li><li>Tool<ul><li>PDF を OCR して必要な部分だけを Markdown にして返す<ul><li>必要箇所の無いページの内容は無視する</li><li>列挙した項目が含まれる表を対象とする</li></ul></li></ul></li></ul><p>プロンプトのチューニングなど行っていないので悪しからず。</p><h2 id=claude->Claude の設定</h2><p><code>claude_desktop_config.json</code> はこのように</p><div class=highlight><pre class=chroma><code class=language-json data-lang=json><span class=p>{</span>
    <span class=nt>&#34;mcpServers&#34;</span><span class=p>:</span> <span class=p>{</span>
        <span class=nt>&#34;playwright_mcp&#34;</span><span class=p>:</span> <span class=p>{</span>
            <span class=nt>&#34;command&#34;</span><span class=p>:</span> <span class=s2>&#34;npx&#34;</span><span class=p>,</span>
            <span class=nt>&#34;args&#34;</span><span class=p>:</span> <span class=p>[</span>
                <span class=s2>&#34;@playwright/mcp@latest&#34;</span>
            <span class=p>]</span>
        <span class=p>}</span><span class=p>,</span>
        <span class=nt>&#34;local_gov_budget&#34;</span><span class=p>:</span> <span class=p>{</span>
            <span class=nt>&#34;command&#34;</span><span class=p>:</span> <span class=s2>&#34;/home/tbsmcd/.local/bin/uv&#34;</span><span class=p>,</span>
            <span class=nt>&#34;args&#34;</span><span class=p>:</span> <span class=p>[</span>
                <span class=s2>&#34;--directory&#34;</span><span class=p>,</span>
                <span class=s2>&#34;/path/to/dir/local_gov_budget/&#34;</span><span class=p>,</span>
                <span class=s2>&#34;run&#34;</span><span class=p>,</span>
                <span class=s2>&#34;main.py&#34;</span>
            <span class=p>]</span>
        <span class=p>}</span>
    <span class=p>}</span>
<span class=p>}</span>

</code></pre></div><h2 id=heading>動作</h2><div style=position:relative;padding-bottom:56.25%;height:0;overflow:hidden><iframe src=https://www.youtube.com/embed/4mQFmrsQTP0 style=position:absolute;top:0;left:0;width:100%;height:100%;border:0 allowfullscreen title="YouTube Video"></iframe></div><p>滋賀県草津市の2025年度予算から教育費を取得するまでを2倍速で。</p><p>これぐらい簡単に AI エージェントを作成できるのは MCP あってこそだと思う。</p></main><div class=tag-list>Tags:
<span><a href=/tags/mcp>MCP</a></span></div><footer>Mochida Tsubasa (@tbsmcd)<br><a href=https://docs.google.com/forms/d/e/1FAIpQLScLrngN5Znk15zTy06N9qjO3Mi_ubIrXrX9cfYFid_2-mmbQQ/viewform>Contact</a>, <a href=/index.xml>Feed</a></footer></div></body></html>